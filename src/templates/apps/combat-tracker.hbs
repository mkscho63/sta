<ol class="combat-tracker">
    {{#each turns}}
      <li class="combatant {{ css }} dispo-{{ disposition.name }}"
        {{#if disposition.color}}style="--disposition-color: {{ disposition.color }};"{{/if}}
        data-combatant-id="{{ id }}" data-action="activateCombatant">

        <img class="token-image" src="{{ img }}" alt="{{ name }}" loading="lazy">

        {{!-- Name & Controls --}}
        <div class="token-name">
            <strong class="name">{{ name }}</strong>
            <div class="combatant-controls">
                {{#if @root.user.isGM}}
                <button type="button" class="inline-control combatant-control icon fa-solid fa-eye-slash {{#if hidden}}active{{/if}}"
                        data-action="toggleHidden" data-tooltip aria-label="{{ localize "COMBAT.ToggleVis" }}"></button>
                <button type="button" class="inline-control combatant-control icon fa-solid fa-skull {{#if isDefeated}}active{{/if}}"
                        data-action="toggleDefeated" data-tooltip
                        aria-label="{{ localize "COMBAT.ToggleDead" }}"></button>
                {{/if}}
                {{#if canPing}}
                <button type="button" class="inline-control combatant-control icon fa-solid fa-bullseye-arrow"
                        data-action="pingCombatant" data-tooltip
                        aria-label="{{ localize "COMBAT.PingCombatant" }}"></button>
                {{/if}}
                {{#unless @root.user.isGM}}
                <button type="button" class="inline-control combatant-control icon fa-solid fa-arrows-to-eye"
                        data-action="panToCombatant" data-tooltip
                        aria-label="{{ localize "COMBAT.PanToCombatant" }}"></button>
                {{/unless}}
                {{!-- TODO: Target Control --}}
                <div class="token-effects" data-tooltip-html="{{ effects.tooltip }}">
                    {{#each effects.icons}}
                    <img class="token-effect" src="{{ img }}" alt="{{ name }}">
                    {{/each}}
                </div>
            </div>
        </div>

        {{!-- Resource --}}
        {{#if resource includeZero=true}}
        <div class="token-resource">
            <span class="resource">{{ resource }}</span>
        </div>
        {{/if}}

        {{!-- Actions Remaining --}}
        <div class="token-actions-remaining" data-tooltip="{{ localize 'sta.combat.restoreaction' }}">
          {{#if @root.user.isGM}}
            <button type="button" class="inline-control combatant-control icon fa-solid fa-circle-plus" data-action="incAction"
            aria-label="{{ localize 'sta.combat.grantOneAction' }}"></button>
          {{/if}}
          <span class="actions-remaining">
            {{ actionsRemaining }} / {{ actionsPerRound }}
          </span>
        </div>

        {{!-- Turn Completed Toggle Button --}}
		<div class="token-turn-completed">
			<a
				class="sta-combatant-control"
				{{#if turnDone}}
					style="color: var(--color-text-subtle);"
				{{/if}}
				{{#if @root.user.isGM}}
					data-tooltip="{{localize 'sta.combat.togglecombatantsturndone'}}"
				{{else}}
					{{#if turnDone}}
						data-tooltip="{{localize 'sta.combat.combatantsturndone'}}"
					{{else}}
						data-tooltip="{{localize 'sta.combat.combatantsturnnotdone'}}"
					{{/if}}
				{{/if}}
				data-action="toggleCombatantTurnDone"
			>
				<i class="fa-solid fa-circle-check fa-xl"></i>
			</a>
		</div>
    </li>
    {{/each}}
</ol>